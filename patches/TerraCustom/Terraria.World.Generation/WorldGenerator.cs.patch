--- src/Terraria\Terraria.World.Generation\WorldGenerator.cs
+++ src/TerraCustom\Terraria.World.Generation\WorldGenerator.cs
@@ -2,12 +2,13 @@
 using System.Collections.Generic;
 using System.Diagnostics;
 using Terraria.GameContent.UI.States;
+using Terraria.IO;
 
 namespace Terraria.World.Generation
 {
 	internal class WorldGenerator
 	{
-		private List<GenPass> _passes = new List<GenPass>();
+		public List<GenPass> _passes = new List<GenPass>();
 		private float _totalLoadWeight;
 
 		public void Append(GenPass pass)
@@ -18,6 +19,7 @@
 
 		public void GenerateWorld(GenerationProgress progress = null)
 		{
+			string originalWorldName = Main.worldName;
 			Stopwatch stopwatch = new Stopwatch();
 			float num = 0f;
 			foreach (GenPass current in this._passes)
@@ -31,7 +33,9 @@
 			progress.TotalWeight = num;
 			string text = "";
 			Main.MenuUI.SetState(new UIWorldLoad(progress));
+			//    Main.menuMode = Terraria.MenuModes.a;
 			Main.menuMode = 888;
+			int a = 0;
 			foreach (GenPass current2 in this._passes)
 			{
 				stopwatch.Start();
@@ -49,7 +53,17 @@
 						",\n"
 					});
 				stopwatch.Reset();
+				if (Main.setting.GenerateWldEachStep)
+				{
+					a++;
+					Main.worldName = originalWorldName + "_" + a.ToString("D2");
+					Main.WorldFileMetadata = FileMetadata.FromCurrentSettings(FileType.World);
+					Main.ActiveWorldFileData = WorldFile.CreateMetadata(Main.worldName, false, Main.expertMode);
+					Terraria.IO.WorldFile.saveWorld(false, true);
+				}
 			}
+			Main.worldName = originalWorldName;
+			Main.ActiveWorldFileData = WorldFile.CreateMetadata(Main.worldName, false, Main.expertMode);
 		}
 	}
 }

